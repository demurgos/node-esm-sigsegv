import { lazyProperties } from "../_helpers/lazy-properties";
import { createLazyOptionsError } from "../errors/lazy-options";
export const name = "custom";
export class CustomType {
    constructor(options) {
        this.name = name;
        this._options = options;
        if (typeof options !== "function") {
            this._applyOptions();
        }
        else {
            lazyProperties(this, this._applyOptions, ["read", "write", "testError", "equals", "clone"]);
        }
    }
    test(val) {
        return this.testError(val) === undefined;
    }
    _applyOptions() {
        if (this._options === undefined) {
            throw createLazyOptionsError(this);
        }
        const options = typeof this._options === "function" ? this._options() : this._options;
        Object.assign(this, {
            read: options.read,
            write: options.write,
            testError: options.testError,
            equals: options.equals,
            clone: options.clone,
        });
    }
}

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9saWIvdHlwZXMvY3VzdG9tLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBRSxjQUFjLEVBQUUsTUFBTSw2QkFBNkIsQ0FBQztBQUU3RCxPQUFPLEVBQUUsc0JBQXNCLEVBQUUsTUFBTSx3QkFBd0IsQ0FBQztBQUdoRSxNQUFNLENBQUMsTUFBTSxJQUFJLEdBQVMsUUFBUSxDQUFDO0FBZ0JuQyxNQUFNLE9BQU8sVUFBVTtJQVVyQixZQUFZLE9BQW1DO1FBVHRDLFNBQUksR0FBUyxJQUFJLENBQUM7UUFVekIsSUFBSSxDQUFDLFFBQVEsR0FBRyxPQUFPLENBQUM7UUFDeEIsSUFBSSxPQUFPLE9BQU8sS0FBSyxVQUFVLEVBQUU7WUFDakMsSUFBSSxDQUFDLGFBQWEsRUFBRSxDQUFDO1NBQ3RCO2FBQU07WUFDTCxjQUFjLENBQUMsSUFBSSxFQUFFLElBQUksQ0FBQyxhQUFhLEVBQUUsQ0FBQyxNQUFNLEVBQUUsT0FBTyxFQUFFLFdBQVcsRUFBRSxRQUFRLEVBQUUsT0FBTyxDQUFDLENBQUMsQ0FBQztTQUM3RjtJQUNILENBQUM7SUFFRCxJQUFJLENBQUMsR0FBTTtRQUNULE9BQU8sSUFBSSxDQUFDLFNBQVMsQ0FBQyxHQUFHLENBQUMsS0FBSyxTQUFTLENBQUM7SUFDM0MsQ0FBQztJQUVPLGFBQWE7UUFDbkIsSUFBSSxJQUFJLENBQUMsUUFBUSxLQUFLLFNBQVMsRUFBRTtZQUMvQixNQUFNLHNCQUFzQixDQUFDLElBQUksQ0FBQyxDQUFDO1NBQ3BDO1FBQ0QsTUFBTSxPQUFPLEdBQXlCLE9BQU8sSUFBSSxDQUFDLFFBQVEsS0FBSyxVQUFVLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxRQUFRLEVBQUUsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQztRQUM1RyxNQUFNLENBQUMsTUFBTSxDQUNYLElBQUksRUFDSjtZQUNFLElBQUksRUFBRSxPQUFPLENBQUMsSUFBSTtZQUNsQixLQUFLLEVBQUUsT0FBTyxDQUFDLEtBQUs7WUFDcEIsU0FBUyxFQUFFLE9BQU8sQ0FBQyxTQUFTO1lBQzVCLE1BQU0sRUFBRSxPQUFPLENBQUMsTUFBTTtZQUN0QixLQUFLLEVBQUUsT0FBTyxDQUFDLEtBQUs7U0FDckIsQ0FDRixDQUFDO0lBQ0osQ0FBQztDQUNGIiwiZmlsZSI6ImxpYi90eXBlcy9jdXN0b20uanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBsYXp5UHJvcGVydGllcyB9IGZyb20gXCIuLi9faGVscGVycy9sYXp5LXByb3BlcnRpZXNcIjtcbmltcG9ydCB7IExhenksIFJlYWRlciwgVHlwZSwgV3JpdGVyIH0gZnJvbSBcIi4uL2NvcmVcIjtcbmltcG9ydCB7IGNyZWF0ZUxhenlPcHRpb25zRXJyb3IgfSBmcm9tIFwiLi4vZXJyb3JzL2xhenktb3B0aW9uc1wiO1xuXG5leHBvcnQgdHlwZSBOYW1lID0gXCJjdXN0b21cIjtcbmV4cG9ydCBjb25zdCBuYW1lOiBOYW1lID0gXCJjdXN0b21cIjtcblxuZXhwb3J0IHR5cGUgUmVhZDxUPiA9IDxSPihyZWFkZXI6IFJlYWRlcjxSPiwgcmF3OiBSKSA9PiBUO1xuZXhwb3J0IHR5cGUgV3JpdGU8VD4gPSA8Vz4od3JpdGVyOiBXcml0ZXI8Vz4sIHZhbHVlOiBUKSA9PiBXO1xuZXhwb3J0IHR5cGUgVGVzdEVycm9yPFQ+ID0gKHZhbDogVCkgPT4gRXJyb3IgfCB1bmRlZmluZWQ7XG5leHBvcnQgdHlwZSBFcXVhbHM8VD4gPSAodmFsMTogVCwgdmFsMjogVCkgPT4gYm9vbGVhbjtcbmV4cG9ydCB0eXBlIENsb25lPFQ+ID0gKHZhbDogVCkgPT4gVDtcblxuZXhwb3J0IGludGVyZmFjZSBDdXN0b21UeXBlT3B0aW9uczxUPiB7XG4gIHJlYWQ6IFJlYWQ8VD47XG4gIHdyaXRlOiBXcml0ZTxUPjtcbiAgdGVzdEVycm9yOiBUZXN0RXJyb3I8VD47XG4gIGVxdWFsczogRXF1YWxzPFQ+O1xuICBjbG9uZTogQ2xvbmU8VD47XG59XG5cbmV4cG9ydCBjbGFzcyBDdXN0b21UeXBlPFQ+IGltcGxlbWVudHMgVHlwZTxUPiB7XG4gIHJlYWRvbmx5IG5hbWU6IE5hbWUgPSBuYW1lO1xuICByZWFkb25seSByZWFkITogUmVhZDxUPjtcbiAgcmVhZG9ubHkgd3JpdGUhOiBXcml0ZTxUPjtcbiAgcmVhZG9ubHkgdGVzdEVycm9yITogVGVzdEVycm9yPFQ+O1xuICByZWFkb25seSBlcXVhbHMhOiBFcXVhbHM8VD47XG4gIHJlYWRvbmx5IGNsb25lITogQ2xvbmU8VD47XG5cbiAgcHJpdmF0ZSBfb3B0aW9ucz86IExhenk8Q3VzdG9tVHlwZU9wdGlvbnM8VD4+O1xuXG4gIGNvbnN0cnVjdG9yKG9wdGlvbnM6IExhenk8Q3VzdG9tVHlwZU9wdGlvbnM8VD4+KSB7XG4gICAgdGhpcy5fb3B0aW9ucyA9IG9wdGlvbnM7XG4gICAgaWYgKHR5cGVvZiBvcHRpb25zICE9PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgIHRoaXMuX2FwcGx5T3B0aW9ucygpO1xuICAgIH0gZWxzZSB7XG4gICAgICBsYXp5UHJvcGVydGllcyh0aGlzLCB0aGlzLl9hcHBseU9wdGlvbnMsIFtcInJlYWRcIiwgXCJ3cml0ZVwiLCBcInRlc3RFcnJvclwiLCBcImVxdWFsc1wiLCBcImNsb25lXCJdKTtcbiAgICB9XG4gIH1cblxuICB0ZXN0KHZhbDogVCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiB0aGlzLnRlc3RFcnJvcih2YWwpID09PSB1bmRlZmluZWQ7XG4gIH1cblxuICBwcml2YXRlIF9hcHBseU9wdGlvbnMoKTogdm9pZCB7XG4gICAgaWYgKHRoaXMuX29wdGlvbnMgPT09IHVuZGVmaW5lZCkge1xuICAgICAgdGhyb3cgY3JlYXRlTGF6eU9wdGlvbnNFcnJvcih0aGlzKTtcbiAgICB9XG4gICAgY29uc3Qgb3B0aW9uczogQ3VzdG9tVHlwZU9wdGlvbnM8VD4gPSB0eXBlb2YgdGhpcy5fb3B0aW9ucyA9PT0gXCJmdW5jdGlvblwiID8gdGhpcy5fb3B0aW9ucygpIDogdGhpcy5fb3B0aW9ucztcbiAgICBPYmplY3QuYXNzaWduKFxuICAgICAgdGhpcyxcbiAgICAgIHtcbiAgICAgICAgcmVhZDogb3B0aW9ucy5yZWFkLFxuICAgICAgICB3cml0ZTogb3B0aW9ucy53cml0ZSxcbiAgICAgICAgdGVzdEVycm9yOiBvcHRpb25zLnRlc3RFcnJvcixcbiAgICAgICAgZXF1YWxzOiBvcHRpb25zLmVxdWFscyxcbiAgICAgICAgY2xvbmU6IG9wdGlvbnMuY2xvbmUsXG4gICAgICB9LFxuICAgICk7XG4gIH1cbn1cbiJdLCJzb3VyY2VSb290IjoiLi4vLi4ifQ==
