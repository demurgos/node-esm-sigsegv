import chai from "chai";
import { Ucs2StringType } from "../../lib/types/ucs2-string";
import { runTests } from "../helpers/test";
describe("Ucs2StringType", function () {
    describe("basic support", function () {
        const type = new Ucs2StringType({ maxLength: 500 });
        const items = [
            // Valid items
            { name: "\"\"", value: "", valid: true },
            { name: "\"Hello World!\"", value: "Hello World!", valid: true },
            { name: "Drop the bass", value: "‘Ç–Ø√ò«∑ ≈Å∆ï‡©¨ …É…Öœ®œû", valid: true },
            // Invalid items
            /* tslint:disable-next-line:no-construct */
            { name: "new String(\"stringObject\")", value: new String("stringObject"), valid: false },
            { name: "0.5", value: 0.5, valid: false },
            { name: "0.0001", value: 0.0001, valid: false },
            { name: "Infinity", value: Infinity, valid: false },
            { name: "-Infinity", value: -Infinity, valid: false },
            { name: "NaN", value: NaN, valid: false },
            { name: "undefined", value: undefined, valid: false },
            { name: "null", value: null, valid: false },
            { name: "true", value: true, valid: false },
            { name: "false", value: false, valid: false },
            { name: "[]", value: [], valid: false },
            { name: "{}", value: {}, valid: false },
            { name: "new Date()", value: new Date(), valid: false },
            { name: "/regex/", value: /regex/, valid: false },
        ];
        runTests(type, items);
    });
    describe("Simple UCS2 behavior", function () {
        it("should accept the empty string, when requiring length exactly 0", function () {
            chai.assert.isTrue(new Ucs2StringType({ minLength: 0, maxLength: 0 }).test(""));
        });
        it("should accept the string \"a\" (ASCII codepoint), when requiring length exactly 1", function () {
            chai.assert.isTrue(new Ucs2StringType({ minLength: 1, maxLength: 1 }).test("a"));
        });
        it("should accept the string \"‚àë\" (BMP codepoint), when requiring length exactly 1", function () {
            chai.assert.isTrue(new Ucs2StringType({ minLength: 1, maxLength: 1 }).test("‚àë"));
        });
        it("should accept the string \"ùÑû\" (non-BMP codepoint), when requiring length exactly 2", function () {
            chai.assert.isTrue(new Ucs2StringType({ minLength: 2, maxLength: 2 }).test("ùÑû"));
        });
        it("should reject the string \"ùÑû\" (non-BMP codepoint), when requiring length exactly 1", function () {
            chai.assert.isFalse(new Ucs2StringType({ minLength: 1, maxLength: 1 }).test("ùÑû"));
        });
        it("should accept unmatched surrogate halves", function () {
            // ùÑû corresponds to the surrogate pair (0xd834, 0xdd1e)
            const type = new Ucs2StringType({ maxLength: 500 });
            const items = ["\ud834", "a\ud834", "\ud834b", "a\ud834b", "\udd1e", "a\udd1e", "\udd1eb", "a\udd1eb"];
            for (const item of items) {
                it(JSON.stringify(item), function () {
                    chai.assert.isTrue(type.test(item));
                });
            }
        });
        it("should accept reversed (invalid) surrogate pairs", function () {
            chai.assert.isTrue(new Ucs2StringType({ maxLength: 500 }).test("\udd1e\ud834"));
        });
    });
});

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy90ZXN0L3R5cGVzL3VjczItc3RyaW5nLnNwZWMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxJQUFJLE1BQU0sTUFBTSxDQUFDO0FBQ3hCLE9BQU8sRUFBRSxjQUFjLEVBQUUsTUFBTSw2QkFBNkIsQ0FBQztBQUM3RCxPQUFPLEVBQUUsUUFBUSxFQUFjLE1BQU0saUJBQWlCLENBQUM7QUFFdkQsUUFBUSxDQUFDLGdCQUFnQixFQUFFO0lBQ3pCLFFBQVEsQ0FBQyxlQUFlLEVBQUU7UUFDeEIsTUFBTSxJQUFJLEdBQW1CLElBQUksY0FBYyxDQUFDLEVBQUMsU0FBUyxFQUFFLEdBQUcsRUFBQyxDQUFDLENBQUM7UUFFbEUsTUFBTSxLQUFLLEdBQWlCO1lBQzFCLGNBQWM7WUFDZCxFQUFDLElBQUksRUFBRSxNQUFNLEVBQUUsS0FBSyxFQUFFLEVBQUUsRUFBRSxLQUFLLEVBQUUsSUFBSSxFQUFDO1lBQ3RDLEVBQUMsSUFBSSxFQUFFLGtCQUFrQixFQUFFLEtBQUssRUFBRSxjQUFjLEVBQUUsS0FBSyxFQUFFLElBQUksRUFBQztZQUM5RCxFQUFDLElBQUksRUFBRSxlQUFlLEVBQUUsS0FBSyxFQUFFLGVBQWUsRUFBRSxLQUFLLEVBQUUsSUFBSSxFQUFDO1lBQzVELGdCQUFnQjtZQUNoQiwyQ0FBMkM7WUFDM0MsRUFBQyxJQUFJLEVBQUUsOEJBQThCLEVBQUUsS0FBSyxFQUFFLElBQUksTUFBTSxDQUFDLGNBQWMsQ0FBQyxFQUFFLEtBQUssRUFBRSxLQUFLLEVBQUM7WUFDdkYsRUFBQyxJQUFJLEVBQUUsS0FBSyxFQUFFLEtBQUssRUFBRSxHQUFHLEVBQUUsS0FBSyxFQUFFLEtBQUssRUFBQztZQUN2QyxFQUFDLElBQUksRUFBRSxRQUFRLEVBQUUsS0FBSyxFQUFFLE1BQU0sRUFBRSxLQUFLLEVBQUUsS0FBSyxFQUFDO1lBQzdDLEVBQUMsSUFBSSxFQUFFLFVBQVUsRUFBRSxLQUFLLEVBQUUsUUFBUSxFQUFFLEtBQUssRUFB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eEQsTUFBTSxJQUFJLEdBQW1CLElBQUksY0FBYyxDQUFDLEVBQUMsU0FBUyxFQUFFLEdBQUcsRUFBQyxDQUFDLENBQUM7WUFDbEUsTUFBTSxLQUFLLEdBQWEsQ0FBQyxRQUFRLEVBQUUsU0FBUyxFQUFFLFNBQVMsRUFBRSxVQUFVLEVBQUUsUUFBUSxFQUFFLFNBQVMsRUFBRSxTQUFTLEVBQUUsVUFBVSxDQUFDLENBQUM7WUFDakgsS0FBSyxNQUFNLElBQUksSUFBSSxLQUFLLEVBQUU7Z0JBQ3hCLEVBQUUsQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxFQUFFO29CQUN2QixJQUFJLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUM7Z0JBQ3RDLENBQUMsQ0FBQyxDQUFDO2FBQ0o7UUFDSCxDQUFDLENBQUMsQ0FBQztRQUNILEVBQUUsQ0FBQyxrREFBa0QsRUFBRTtZQUNyRCxJQUFJLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxJQUFJLGNBQWMsQ0FBQyxFQUFDLFNBQVMsRUFBRSxHQUFHLEVBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxjQUFjLENBQUMsQ0FBQyxDQUFDO1FBQ2hGLENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7QUFDTCxDQUFDLENBQUMsQ0FBQyIsImZpbGUiOiJ0ZXN0L3R5cGVzL3VjczItc3RyaW5nLnNwZWMuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgY2hhaSBmcm9tIFwiY2hhaVwiO1xuaW1wb3J0IHsgVWNzMlN0cmluZ1R5cGUgfSBmcm9tIFwiLi4vLi4vbGliL3R5cGVzL3VjczItc3RyaW5nXCI7XG5pbXBvcnQgeyBydW5UZXN0cywgVHlwZWRWYWx1ZSB9IGZyb20gXCIuLi9oZWxwZXJzL3Rlc3RcIjtcblxuZGVzY3JpYmUoXCJVY3MyU3RyaW5nVHlwZVwiLCBmdW5jdGlvbiAoKSB7XG4gIGRlc2NyaWJlKFwiYmFzaWMgc3VwcG9ydFwiLCBmdW5jdGlvbiAoKSB7XG4gICAgY29uc3QgdHlwZTogVWNzMlN0cmluZ1R5cGUgPSBuZXcgVWNzMlN0cmluZ1R5cGUoe21heExlbmd0aDogNTAwfSk7XG5cbiAgICBjb25zdCBpdGVtczogVHlwZWRWYWx1ZVtdID0gW1xuICAgICAgLy8gVmFsaWQgaXRlbXNcbiAgICAgIHtuYW1lOiBcIlxcXCJcXFwiXCIsIHZhbHVlOiBcIlwiLCB2YWxpZDogdHJ1ZX0sXG4gICAgICB7bmFtZTogXCJcXFwiSGVsbG8gV29ybGQhXFxcIlwiLCB2YWx1ZTogXCJIZWxsbyBXb3JsZCFcIiwgdmFsaWQ6IHRydWV9LFxuICAgICAge25hbWU6IFwiRHJvcCB0aGUgYmFzc1wiLCB2YWx1ZTogXCLUgtCvw5jHtyDFgcaV4KmsIMmDyYXPqM+eXCIsIHZhbGlkOiB0cnVlfSxcbiAgICAgIC8vIEludmFsaWQgaXRlbXNcbiAgICAgIC8qIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTpuby1jb25zdHJ1Y3QgKi9cbiAgICAgIHtuYW1lOiBcIm5ldyBTdHJpbmcoXFxcInN0cmluZ09iamVjdFxcXCIpXCIsIHZhbHVlOiBuZXcgU3RyaW5nKFwic3RyaW5nT2JqZWN0XCIpLCB2YWxpZDogZmFsc2V9LFxuICAgICAge25hbWU6IFwiMC41XCIsIHZhbHVlOiAwLjUsIHZhbGlkOiBmYWxzZX0sXG4gICAgICB7bmFtZTogXCIwLjAwMDFcIiwgdmFsdWU6IDAuMDAwMSwgdmFsaWQ6IGZhbHNlfSxcbiAgICAgIHtuYW1lOiBcIkluZmluaXR5XCIsIHZhbHVlOiBJbmZpbml0eSwgdmFsaWQ6IGZhbHNlfSxcbiAgICAgIHtuYW1lOiBcIi1JbmZpbml0eVwiLCB2YWx1ZTogLUluZmluaXR5LCB2YWxpZDogZmFsc2V9LFxuICAgICAge25hbWU6IFwiTmFOXCIsIHZhbHVlOiBOYU4sIHZhbGlkOiBmYWxzZX0sXG4gICAgICB7bmFtZTogXCJ1bmRlZmluZWRcIiwgdmFsdWU6IHVuZGVmaW5lZCwgdmFsaWQ6IGZhbHNlfSxcbiAgICAgIHtuYW1lOiBcIm51bGxcIiwgdmFsdWU6IG51bGwsIHZhbGlkOiBmYWxzZX0sXG4gICAgICB7bmFtZTogXCJ0cnVlXCIsIHZhbHVlOiB0cnVlLCB2YWxpZDogZmFsc2V9LFxuICAgICAge25hbWU6IFwiZmFsc2VcIiwgdmFsdWU6IGZhbHNlLCB2YWxpZDogZmFsc2V9LFxuICAgICAge25hbWU6IFwiW11cIiwgdmFsdWU6IFtdLCB2YWxpZDogZmFsc2V9LFxuICAgICAge25hbWU6IFwie31cIiwgdmFsdWU6IHt9LCB2YWxpZDogZmFsc2V9LFxuICAgICAge25hbWU6IFwibmV3IERhdGUoKVwiLCB2YWx1ZTogbmV3IERhdGUoKSwgdmFsaWQ6IGZhbHNlfSxcbiAgICAgIHtuYW1lOiBcIi9yZWdleC9cIiwgdmFsdWU6IC9yZWdleC8sIHZhbGlkOiBmYWxzZX0sXG4gICAgXTtcblxuICAgIHJ1blRlc3RzKHR5cGUsIGl0ZW1zKTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoXCJTaW1wbGUgVUNTMiBiZWhhdmlvclwiLCBmdW5jdGlvbiAoKSB7XG4gICAgaXQoXCJzaG91bGQgYWNjZXB0IHRoZSBlbXB0eSBzdHJpbmcsIHdoZW4gcmVxdWlyaW5nIGxlbmd0aCBleGFjdGx5IDBcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgY2hhaS5hc3NlcnQuaXNUcnVlKG5ldyBVY3MyU3RyaW5nVHlwZSh7bWluTGVuZ3RoOiAwLCBtYXhMZW5ndGg6IDB9KS50ZXN0KFwiXCIpKTtcbiAgICB9KTtcbiAgICBpdChcInNob3VsZCBhY2NlcHQgdGhlIHN0cmluZyBcXFwiYVxcXCIgKEFTQ0lJIGNvZGVwb2ludCksIHdoZW4gcmVxdWlyaW5nIGxlbmd0aCBleGFjdGx5IDFcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgY2hhaS5hc3NlcnQuaXNUcnVlKG5ldyBVY3MyU3RyaW5nVHlwZSh7bWluTGVuZ3RoOiAxLCBtYXhMZW5ndGg6IDF9KS50ZXN0KFwiYVwiKSk7XG4gICAgfSk7XG4gICAgaXQoXCJzaG91bGQgYWNjZXB0IHRoZSBzdHJpbmcgXFxcIuKIkVxcXCIgKEJNUCBjb2RlcG9pbnQpLCB3aGVuIHJlcXVpcmluZyBsZW5ndGggZXhhY3RseSAxXCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgIGNoYWkuYXNzZXJ0LmlzVHJ1ZShuZXcgVWNzMlN0cmluZ1R5cGUoe21pbkxlbmd0aDogMSwgbWF4TGVuZ3RoOiAxfSkudGVzdChcIuKIkVwiKSk7XG4gICAgfSk7XG4gICAgaXQoXCJzaG91bGQgYWNjZXB0IHRoZSBzdHJpbmcgXFxcIvCdhJ5cXFwiIChub24tQk1QIGNvZGVwb2ludCksIHdoZW4gcmVxdWlyaW5nIGxlbmd0aCBleGFjdGx5IDJcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgY2hhaS5hc3NlcnQuaXNUcnVlKG5ldyBVY3MyU3RyaW5nVHlwZSh7bWluTGVuZ3RoOiAyLCBtYXhMZW5ndGg6IDJ9KS50ZXN0KFwi8J2EnlwiKSk7XG4gICAgfSk7XG4gICAgaXQoXCJzaG91bGQgcmVqZWN0IHRoZSBzdHJpbmcgXFxcIvCdhJ5cXFwiIChub24tQk1QIGNvZGVwb2ludCksIHdoZW4gcmVxdWlyaW5nIGxlbmd0aCBleGFjdGx5IDFcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgY2hhaS5hc3NlcnQuaXNGYWxzZShuZXcgVWNzMlN0cmluZ1R5cGUoe21pbkxlbmd0aDogMSwgbWF4TGVuZ3RoOiAxfSkudGVzdChcIvCdhJ5cIikpO1xuICAgIH0pO1xuICAgIGl0KFwic2hvdWxkIGFjY2VwdCB1bm1hdGNoZWQgc3Vycm9nYXRlIGhhbHZlc1wiLCBmdW5jdGlvbiAoKSB7XG4gICAgICAvLyDwnYSeIGNvcnJlc3BvbmRzIHRvIHRoZSBzdXJyb2dhdGUgcGFpciAoMHhkODM0LCAweGRkMWUpXG4gICAgICBjb25zdCB0eXBlOiBVY3MyU3RyaW5nVHlwZSA9IG5ldyBVY3MyU3RyaW5nVHlwZSh7bWF4TGVuZ3RoOiA1MDB9KTtcbiAgICAgIGNvbnN0IGl0ZW1zOiBzdHJpbmdbXSA9IFtcIlxcdWQ4MzRcIiwgXCJhXFx1ZDgzNFwiLCBcIlxcdWQ4MzRiXCIsIFwiYVxcdWQ4MzRiXCIsIFwiXFx1ZGQxZVwiLCBcImFcXHVkZDFlXCIsIFwiXFx1ZGQxZWJcIiwgXCJhXFx1ZGQxZWJcIl07XG4gICAgICBmb3IgKGNvbnN0IGl0ZW0gb2YgaXRlbXMpIHtcbiAgICAgICAgaXQoSlNPTi5zdHJpbmdpZnkoaXRlbSksIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICBjaGFpLmFzc2VydC5pc1RydWUodHlwZS50ZXN0KGl0ZW0pKTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfSk7XG4gICAgaXQoXCJzaG91bGQgYWNjZXB0IHJldmVyc2VkIChpbnZhbGlkKSBzdXJyb2dhdGUgcGFpcnNcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgY2hhaS5hc3NlcnQuaXNUcnVlKG5ldyBVY3MyU3RyaW5nVHlwZSh7bWF4TGVuZ3RoOiA1MDB9KS50ZXN0KFwiXFx1ZGQxZVxcdWQ4MzRcIikpO1xuICAgIH0pO1xuICB9KTtcbn0pO1xuIl0sInNvdXJjZVJvb3QiOiIuLi8uLiJ9
