import chai from "chai";
import { $Boolean } from "../../lib/builtins/boolean";
import { $Uint8 } from "../../lib/builtins/uint8";
import { JsonReader } from "../../lib/readers/json";
import { ArrayType } from "../../lib/types/array";
import { IntegerType } from "../../lib/types/integer";
import { JsonWriter } from "../../lib/writers/json";
import { runTests } from "../helpers/test";
describe("ArrayType", function () {
    describe("General", function () {
        const $IntArray = new ArrayType({
            itemType: new IntegerType(),
            maxLength: 2,
        });
        const items = [
            {
                value: [],
                valid: true,
                output: {
                    json: "[]",
                },
            },
            {
                value: [1],
                valid: true,
                output: {
                    json: "[1]",
                },
            },
            {
                value: [2, 3],
                valid: true,
                output: {
                    json: "[2,3]",
                },
            },
            {
                value: [4, 5, 6],
                valid: false,
            },
            {
                value: [0.5],
                valid: false,
            },
            {
                name: "[null]",
                value: [null],
                valid: false,
            },
            {
                name: "[undefined]",
                value: [undefined],
                valid: false,
            },
            {
                name: "new Array()",
                value: new Array(),
                valid: true,
            },
            {
                name: "new Array(0)",
                value: new Array(0),
                valid: true,
            },
            {
                name: "new Array(1)",
                value: new Array(1),
                valid: false,
            },
            { name: "new Date(0)", value: new Date(0), valid: false },
            { name: "0", value: 0, valid: false },
            { name: "1", value: 1, valid: false },
            { name: "\"\"", value: "", valid: false },
            { name: "\"0\"", value: "0", valid: false },
            { name: "\"true\"", value: "true", valid: false },
            { name: "\"false\"", value: "false", valid: false },
            { name: "Infinity", value: Infinity, valid: false },
            { name: "-Infinity", value: -Infinity, valid: false },
            { name: "NaN", value: NaN, valid: false },
            { name: "undefined", value: undefined, valid: false },
            { name: "null", value: null, valid: false },
            { name: "{}", value: {}, valid: false },
            { name: "/regex/", value: /regex/, valid: false },
        ];
        runTests($IntArray, items);
    });
    describe("Min/max length", function () {
        const $IntArray = new ArrayType({
            itemType: $Uint8,
            minLength: 2,
            maxLength: 4,
        });
        const items = [
            {
                value: [],
                valid: false,
            },
            {
                value: [0],
                valid: false,
            },
            {
                value: [0, 1],
                valid: true,
                output: {
                    json: "[0,1]",
                },
            },
            {
                value: [0, 1, 2],
                valid: true,
                output: {
                    json: "[0,1,2]",
                },
            },
            {
                value: [0, 1, 2, 3],
                valid: true,
                output: {
                    json: "[0,1,2,3]",
                },
            },
            {
                value: [0, 1, 2, 3, 4],
                valid: false,
            },
        ];
        runTests($IntArray, items);
    });
    describe("NestedArray", function () {
        const jsonWriter = new JsonWriter();
        const jsonReader = new JsonReader();
        const $NestedBooleanArray = new ArrayType({
            itemType: new ArrayType({
                itemType: $Boolean,
                maxLength: Infinity,
            }),
            maxLength: Infinity,
        });
        it("should be possible to write nested arrays", function () {
            const input = [[true], [false, true]];
            const actual = $NestedBooleanArray.write(jsonWriter, input);
            const expected = "[[true],[false,true]]";
            chai.assert.deepEqual(actual, expected);
        });
        it("should be possible to read nested arrays", function () {
            const input = "[[true],[false,true]]";
            const actual = $NestedBooleanArray.read(jsonReader, input);
            const expected = [[true], [false, true]];
            chai.assert.deepEqual(actual, expected);
        });
    });
});

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy90ZXN0L3R5cGVzL2FycmF5LnNwZWMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxJQUFJLE1BQU0sTUFBTSxDQUFDO0FBQ3hCLE9BQU8sRUFBRSxRQUFRLEVBQUUsTUFBTSw0QkFBNEIsQ0FBQztBQUN0RCxPQUFPLEVBQUUsTUFBTSxFQUFFLE1BQU0sMEJBQTBCLENBQUM7QUFDbEQsT0FBTyxFQUFFLFVBQVUsRUFBRSxNQUFNLHdCQUF3QixDQUFDO0FBQ3BELE9BQU8sRUFBZSxTQUFTLEVBQUUsTUFBTSx1QkFBdUIsQ0FBQztBQUMvRCxPQUFPLEVBQUUsV0FBVyxFQUFFLE1BQU0seUJBQXlCLENBQUM7QUFDdEQsT0FBTyxFQUFFLFVBQVUsRUFBRSxNQUFNLHdCQUF3QixDQUFDO0FBQ3BELE9BQU8sRUFBRSxRQUFRLEVBQWMsTUFBTSxpQkFBaUIsQ0FBQztBQUV2RCxRQUFRLENBQUMsV0FBVyxFQUFFO0lBQ3BCLFFBQVEsQ0FBQyxTQUFTLEVBQUU7UUFDbEIsTUFBTSxTQUFTLEdBQXNCLElBQUksU0FBUyxDQUFDO1lBQ2pELFFBQVEsRUFBRSxJQUFJLFdBQVcsRUFBRTtZQUMzQixTQUFTLEVBQUUsQ0FBQztTQUNiLENBQUMsQ0FBQztRQUVILE1BQU0sS0FBSyxHQUFpQjtZQUMxQjtnQkFDRSxLQUFLLEVBQUUsRUFBRTtnQkFDVCxLQUFLLEVBQUUsSUFBSTtnQkFDWCxNQUFNLEVBQUU7b0JBQ04sSUFBSSxFQUFFLElBQUk7aUJBQ1g7YUFDRjtZQUNEO2dCQUNFLEtBQUssRUFBRSxDQUFDLENBQUMsQ0FBQztnQkFDVixLQUFLLEVBQUUsSUFBSTtnQkFDWCxNQUFNLEVBQUU7b0JBQ04sSUFBSSxFQUFFLEtBQUs7aUJBQ1o7YUFDRjtZQUNEO2dCQUNFLEtBQUssRUFBRSxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUM7Z0JBQ2IsS0FBSyxFQUFFLElBQUk7Z0JBQ1gsTUFBTSxFQUFFO29CQUNOLElBQUksRUFBRSxPQUFPO2lC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LFFBQVEsRUFBRSxRQUFRO2dCQUNsQixTQUFTLEVBQUUsUUFBUTthQUNwQixDQUFDO1lBQ0YsU0FBUyxFQUFFLFFBQVE7U0FDcEIsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLDJDQUEyQyxFQUFFO1lBQzlDLE1BQU0sS0FBSyxHQUFnQixDQUFDLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxLQUFLLEVBQUUsSUFBSSxDQUFDLENBQUMsQ0FBQztZQUNuRCxNQUFNLE1BQU0sR0FBVyxtQkFBbUIsQ0FBQyxLQUFLLENBQUMsVUFBVSxFQUFFLEtBQUssQ0FBQyxDQUFDO1lBQ3BFLE1BQU0sUUFBUSxHQUFXLHVCQUF1QixDQUFDO1lBQ2pELElBQUksQ0FBQyxNQUFNLENBQUMsU0FBUyxDQUFDLE1BQU0sRUFBRSxRQUFRLENBQUMsQ0FBQztRQUMxQyxDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQywwQ0FBMEMsRUFBRTtZQUM3QyxNQUFNLEtBQUssR0FBVyx1QkFBdUIsQ0FBQztZQUM5QyxNQUFNLE1BQU0sR0FBZ0IsbUJBQW1CLENBQUMsSUFBSSxDQUFDLFVBQVUsRUFBRSxLQUFLLENBQUMsQ0FBQztZQUN4RSxNQUFNLFFBQVEsR0FBZ0IsQ0FBQyxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsS0FBSyxFQUFFLElBQUksQ0FBQyxDQUFDLENBQUM7WUFDdEQsSUFBSSxDQUFDLE1BQU0sQ0FBQyxTQUFTLENBQUMsTUFBTSxFQUFFLFFBQVEsQ0FBQyxDQUFDO1FBQzFDLENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7QUFDTCxDQUFDLENBQUMsQ0FBQyIsImZpbGUiOiJ0ZXN0L3R5cGVzL2FycmF5LnNwZWMuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgY2hhaSBmcm9tIFwiY2hhaVwiO1xuaW1wb3J0IHsgJEJvb2xlYW4gfSBmcm9tIFwiLi4vLi4vbGliL2J1aWx0aW5zL2Jvb2xlYW5cIjtcbmltcG9ydCB7ICRVaW50OCB9IGZyb20gXCIuLi8uLi9saWIvYnVpbHRpbnMvdWludDhcIjtcbmltcG9ydCB7IEpzb25SZWFkZXIgfSBmcm9tIFwiLi4vLi4vbGliL3JlYWRlcnMvanNvblwiO1xuaW1wb3J0IHsgQXJyYXlJb1R5cGUsIEFycmF5VHlwZSB9IGZyb20gXCIuLi8uLi9saWIvdHlwZXMvYXJyYXlcIjtcbmltcG9ydCB7IEludGVnZXJUeXBlIH0gZnJvbSBcIi4uLy4uL2xpYi90eXBlcy9pbnRlZ2VyXCI7XG5pbXBvcnQgeyBKc29uV3JpdGVyIH0gZnJvbSBcIi4uLy4uL2xpYi93cml0ZXJzL2pzb25cIjtcbmltcG9ydCB7IHJ1blRlc3RzLCBUeXBlZFZhbHVlIH0gZnJvbSBcIi4uL2hlbHBlcnMvdGVzdFwiO1xuXG5kZXNjcmliZShcIkFycmF5VHlwZVwiLCBmdW5jdGlvbiAoKSB7XG4gIGRlc2NyaWJlKFwiR2VuZXJhbFwiLCBmdW5jdGlvbiAoKSB7XG4gICAgY29uc3QgJEludEFycmF5OiBBcnJheVR5cGU8bnVtYmVyPiA9IG5ldyBBcnJheVR5cGUoe1xuICAgICAgaXRlbVR5cGU6IG5ldyBJbnRlZ2VyVHlwZSgpLFxuICAgICAgbWF4TGVuZ3RoOiAyLFxuICAgIH0pO1xuXG4gICAgY29uc3QgaXRlbXM6IFR5cGVkVmFsdWVbXSA9IFtcbiAgICAgIHtcbiAgICAgICAgdmFsdWU6IFtdLFxuICAgICAgICB2YWxpZDogdHJ1ZSxcbiAgICAgICAgb3V0cHV0OiB7XG4gICAgICAgICAganNvbjogXCJbXVwiLFxuICAgICAgICB9LFxuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgdmFsdWU6IFsxXSxcbiAgICAgICAgdmFsaWQ6IHRydWUsXG4gICAgICAgIG91dHB1dDoge1xuICAgICAgICAgIGpzb246IFwiWzFdXCIsXG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgICAge1xuICAgICAgICB2YWx1ZTogWzIsIDNdLFxuICAgICAgICB2YWxpZDogdHJ1ZSxcbiAgICAgICAgb3V0cHV0OiB7XG4gICAgICAgICAganNvbjogXCJbMiwzXVwiLFxuICAgICAgICB9LFxuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgdmFsdWU6IFs0LCA1LCA2XSxcbiAgICAgICAgdmFsaWQ6IGZhbHNlLFxuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgdmFsdWU6IFswLjVdLFxuICAgICAgICB2YWxpZDogZmFsc2UsXG4gICAgICB9LFxuICAgICAge1xuICAgICAgICBuYW1lOiBcIltudWxsXVwiLFxuICAgICAgICB2YWx1ZTogW251bGxdLFxuICAgICAgICB2YWxpZDogZmFsc2UsXG4gICAgICB9LFxuICAgICAge1xuICAgICAgICBuYW1lOiBcIlt1bmRlZmluZWRdXCIsXG4gICAgICAgIHZhbHVlOiBbdW5kZWZpbmVkXSxcbiAgICAgICAgdmFsaWQ6IGZhbHNlLFxuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgbmFtZTogXCJuZXcgQXJyYXkoKVwiLFxuICAgICAgICB2YWx1ZTogbmV3IEFycmF5KCksXG4gICAgICAgIHZhbGlkOiB0cnVlLFxuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgbmFtZTogXCJuZXcgQXJyYXkoMClcIixcbiAgICAgICAgdmFsdWU6IG5ldyBBcnJheSgwKSxcbiAgICAgICAgdmFsaWQ6IHRydWUsXG4gICAgICB9LFxuICAgICAge1xuICAgICAgICBuYW1lOiBcIm5ldyBBcnJheSgxKVwiLFxuICAgICAgICB2YWx1ZTogbmV3IEFycmF5KDEpLFxuICAgICAgICB2YWxpZDogZmFsc2UsXG4gICAgICB9LFxuXG4gICAgICB7bmFtZTogXCJuZXcgRGF0ZSgwKVwiLCB2YWx1ZTogbmV3IERhdGUoMCksIHZhbGlkOiBmYWxzZX0sXG4gICAgICB7bmFtZTogXCIwXCIsIHZhbHVlOiAwLCB2YWxpZDogZmFsc2V9LFxuICAgICAge25hbWU6IFwiMVwiLCB2YWx1ZTogMSwgdmFsaWQ6IGZhbHNlfSxcbiAgICAgIHtuYW1lOiBcIlxcXCJcXFwiXCIsIHZhbHVlOiBcIlwiLCB2YWxpZDogZmFsc2V9LFxuICAgICAge25hbWU6IFwiXFxcIjBcXFwiXCIsIHZhbHVlOiBcIjBcIiwgdmFsaWQ6IGZhbHNlfSxcbiAgICAgIHtuYW1lOiBcIlxcXCJ0cnVlXFxcIlwiLCB2YWx1ZTogXCJ0cnVlXCIsIHZhbGlkOiBmYWxzZX0sXG4gICAgICB7bmFtZTogXCJcXFwiZmFsc2VcXFwiXCIsIHZhbHVlOiBcImZhbHNlXCIsIHZhbGlkOiBmYWxzZX0sXG4gICAgICB7bmFtZTogXCJJbmZpbml0eVwiLCB2YWx1ZTogSW5maW5pdHksIHZhbGlkOiBmYWxzZX0sXG4gICAgICB7bmFtZTogXCItSW5maW5pdHlcIiwgdmFsdWU6IC1JbmZpbml0eSwgdmFsaWQ6IGZhbHNlfSxcbiAgICAgIHtuYW1lOiBcIk5hTlwiLCB2YWx1ZTogTmFOLCB2YWxpZDogZmFsc2V9LFxuICAgICAge25hbWU6IFwidW5kZWZpbmVkXCIsIHZhbHVlOiB1bmRlZmluZWQsIHZhbGlkOiBmYWxzZX0sXG4gICAgICB7bmFtZTogXCJudWxsXCIsIHZhbHVlOiBudWxsLCB2YWxpZDogZmFsc2V9LFxuICAgICAge25hbWU6IFwie31cIiwgdmFsdWU6IHt9LCB2YWxpZDogZmFsc2V9LFxuICAgICAge25hbWU6IFwiL3JlZ2V4L1wiLCB2YWx1ZTogL3JlZ2V4LywgdmFsaWQ6IGZhbHNlfSxcbiAgICBdO1xuXG4gICAgcnVuVGVzdHMoJEludEFycmF5LCBpdGVtcyk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKFwiTWluL21heCBsZW5ndGhcIiwgZnVuY3Rpb24gKCkge1xuICAgIGNvbnN0ICRJbnRBcnJheTogQXJyYXlUeXBlPG51bWJlcj4gPSBuZXcgQXJyYXlUeXBlKHtcbiAgICAgIGl0ZW1UeXBlOiAkVWludDgsXG4gICAgICBtaW5MZW5ndGg6IDIsXG4gICAgICBtYXhMZW5ndGg6IDQsXG4gICAgfSk7XG5cbiAgICBjb25zdCBpdGVtczogVHlwZWRWYWx1ZVtdID0gW1xuICAgICAge1xuICAgICAgICB2YWx1ZTogW10sXG4gICAgICAgIHZhbGlkOiBmYWxzZSxcbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgIHZhbHVlOiBbMF0sXG4gICAgICAgIHZhbGlkOiBmYWxzZSxcbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgIHZhbHVlOiBbMCwgMV0sXG4gICAgICAgIHZhbGlkOiB0cnVlLFxuICAgICAgICBvdXRwdXQ6IHtcbiAgICAgICAgICBqc29uOiBcIlswLDFdXCIsXG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgICAge1xuICAgICAgICB2YWx1ZTogWzAsIDEsIDJdLFxuICAgICAgICB2YWxpZDogdHJ1ZSxcbiAgICAgICAgb3V0cHV0OiB7XG4gICAgICAgICAganNvbjogXCJbMCwxLDJdXCIsXG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgICAge1xuICAgICAgICB2YWx1ZTogWzAsIDEsIDIsIDNdLFxuICAgICAgICB2YWxpZDogdHJ1ZSxcbiAgICAgICAgb3V0cHV0OiB7XG4gICAgICAgICAganNvbjogXCJbMCwxLDIsM11cIixcbiAgICAgICAgfSxcbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgIHZhbHVlOiBbMCwgMSwgMiwgMywgNF0sXG4gICAgICAgIHZhbGlkOiBmYWxzZSxcbiAgICAgIH0sXG4gICAgXTtcblxuICAgIHJ1blRlc3RzKCRJbnRBcnJheSwgaXRlbXMpO1xuICB9KTtcblxuICBkZXNjcmliZShcIk5lc3RlZEFycmF5XCIsIGZ1bmN0aW9uICgpIHtcbiAgICBjb25zdCBqc29uV3JpdGVyOiBKc29uV3JpdGVyID0gbmV3IEpzb25Xcml0ZXIoKTtcbiAgICBjb25zdCBqc29uUmVhZGVyOiBKc29uUmVhZGVyID0gbmV3IEpzb25SZWFkZXIoKTtcbiAgICBjb25zdCAkTmVzdGVkQm9vbGVhbkFycmF5OiBBcnJheUlvVHlwZTxib29sZWFuW10+ID0gbmV3IEFycmF5VHlwZSh7XG4gICAgICBpdGVtVHlwZTogbmV3IEFycmF5VHlwZSh7XG4gICAgICAgIGl0ZW1UeXBlOiAkQm9vbGVhbixcbiAgICAgICAgbWF4TGVuZ3RoOiBJbmZpbml0eSxcbiAgICAgIH0pLFxuICAgICAgbWF4TGVuZ3RoOiBJbmZpbml0eSxcbiAgICB9KTtcblxuICAgIGl0KFwic2hvdWxkIGJlIHBvc3NpYmxlIHRvIHdyaXRlIG5lc3RlZCBhcnJheXNcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgY29uc3QgaW5wdXQ6IGJvb2xlYW5bXVtdID0gW1t0cnVlXSwgW2ZhbHNlLCB0cnVlXV07XG4gICAgICBjb25zdCBhY3R1YWw6IHN0cmluZyA9ICROZXN0ZWRCb29sZWFuQXJyYXkud3JpdGUoanNvbldyaXRlciwgaW5wdXQpO1xuICAgICAgY29uc3QgZXhwZWN0ZWQ6IHN0cmluZyA9IFwiW1t0cnVlXSxbZmFsc2UsdHJ1ZV1dXCI7XG4gICAgICBjaGFpLmFzc2VydC5kZWVwRXF1YWwoYWN0dWFsLCBleHBlY3RlZCk7XG4gICAgfSk7XG5cbiAgICBpdChcInNob3VsZCBiZSBwb3NzaWJsZSB0byByZWFkIG5lc3RlZCBhcnJheXNcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgY29uc3QgaW5wdXQ6IHN0cmluZyA9IFwiW1t0cnVlXSxbZmFsc2UsdHJ1ZV1dXCI7XG4gICAgICBjb25zdCBhY3R1YWw6IGJvb2xlYW5bXVtdID0gJE5lc3RlZEJvb2xlYW5BcnJheS5yZWFkKGpzb25SZWFkZXIsIGlucHV0KTtcbiAgICAgIGNvbnN0IGV4cGVjdGVkOiBib29sZWFuW11bXSA9IFtbdHJ1ZV0sIFtmYWxzZSwgdHJ1ZV1dO1xuICAgICAgY2hhaS5hc3NlcnQuZGVlcEVxdWFsKGFjdHVhbCwgZXhwZWN0ZWQpO1xuICAgIH0pO1xuICB9KTtcbn0pO1xuIl0sInNvdXJjZVJvb3QiOiIuLi8uLiJ9
